---
import Layout from "@/layouts/Layout.astro"
import AICard from "@@/containers/ai/Card.astro"
import AIResponse from "@@/containers/ai/Response.astro"

const session = Astro.locals.session
let question = undefined

try {
	const data = await Astro.request.formData()
	question = data.get("question")?.toString() ?? ""
} catch (error) {
	question = ""
}
---

<Layout title="MillhioreTFS - AI Response">
	<AIResponse server:defer session={session} question={question}>
		<AICard slot="fallback">
			<p>Waiting for a question...</p>
		</AICard>
	</AIResponse>
</Layout>
